{"ast":null,"code":"var _jsxFileName = \"/Users/sami/Documents/Doctor-Appointment/frontend/src/components/chatbot/Chatbot.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { IoChatbubbleEllipsesSharp, IoSend } from 'react-icons/io5';\nimport './Chatbot.css';\nimport axios from 'axios'; // Ensure axios is imported\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chatbot() {\n  _s();\n  const [isOpen, setIsOpen] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesEndRef = useRef(null);\n  const toggleChatbot = () => {\n    setIsOpen(!isOpen);\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const handleSend = async () => {\n    if (input.trim() === '') return;\n    const userMessage = {\n      type: 'user',\n      text: input\n    };\n    setMessages(prevMessages => [...prevMessages, userMessage]);\n    setInput('');\n    setIsLoading(true);\n\n    // Capture the input message here, as `input` will be cleared before the async call\n    const currentInputMessage = input;\n    try {\n      // Prepare chat history for the backend\n      // Note: Your backend doesn't seem to use chatHistory for RAG context,\n      // but if it did, you'd send it like this.\n      const chatHistoryForLLM = messages.map(msg => ({\n        type: msg.type,\n        text: msg.text\n      }));\n\n      // --- CORRECTED AXIOS CALL ---\n      const response = await axios.post('/chat', {\n        // Axios automatically sets Content-Type: application/json\n        // and stringifies the data if it's an object.\n        message: currentInputMessage,\n        // Pass the message directly as part of the data object\n        chatHistory: chatHistoryForLLM // If your backend expects chat history\n      });\n      // --- END CORRECTED AXIOS CALL ---\n\n      // Axios responses are already parsed into .data\n      const data = response.data; // Axios response object has a .data property\n\n      setMessages(prevMessages => [...prevMessages, {\n        type: 'bot',\n        text: data.reply\n      }]);\n    } catch (error) {\n      console.error('Error sending message:', error);\n      // More specific error message if backend returns one\n      const errorMessage = error.response && error.response.data && error.response.data.error ? error.response.data.error : 'Sorry, something went wrong. Please try again.';\n      setMessages(prevMessages => [...prevMessages, {\n        type: 'bot',\n        text: errorMessage\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      handleSend();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chatbot-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-toggle-button\",\n      onClick: toggleChatbot,\n      children: /*#__PURE__*/_jsxDEV(IoChatbubbleEllipsesSharp, {\n        size: 30\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), isOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-window\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Virtual Assistant\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"close-button\",\n          onClick: toggleChatbot,\n          children: \"X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-messages\",\n        children: [messages.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"welcome-message\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Hi there! How can I help you today?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 29\n        }, this), messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${msg.type}`,\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: msg.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 33\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 29\n        }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message bot loading\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-input-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Type your question...\",\n          value: input,\n          onChange: e => setInput(e.target.value),\n          onKeyPress: handleKeyPress,\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSend,\n          disabled: isLoading,\n          children: /*#__PURE__*/_jsxDEV(IoSend, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n}\n_s(Chatbot, \"QF859i97AOo+R4T6s1ykzsKUThY=\");\n_c = Chatbot;\nexport default Chatbot;\nvar _c;\n$RefreshReg$(_c, \"Chatbot\");","map":{"version":3,"names":["React","useState","useEffect","useRef","IoChatbubbleEllipsesSharp","IoSend","axios","jsxDEV","_jsxDEV","Chatbot","_s","isOpen","setIsOpen","messages","setMessages","input","setInput","isLoading","setIsLoading","messagesEndRef","toggleChatbot","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSend","trim","userMessage","type","text","prevMessages","currentInputMessage","chatHistoryForLLM","map","msg","response","post","message","chatHistory","data","reply","error","console","errorMessage","handleKeyPress","e","key","className","children","onClick","size","fileName","_jsxFileName","lineNumber","columnNumber","length","index","ref","placeholder","value","onChange","target","onKeyPress","disabled","_c","$RefreshReg$"],"sources":["/Users/sami/Documents/Doctor-Appointment/frontend/src/components/chatbot/Chatbot.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { IoChatbubbleEllipsesSharp, IoSend } from 'react-icons/io5';\nimport './Chatbot.css';\nimport axios from 'axios'; // Ensure axios is imported\n\nfunction Chatbot() {\n    const [isOpen, setIsOpen] = useState(false);\n    const [messages, setMessages] = useState([]);\n    const [input, setInput] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const messagesEndRef = useRef(null);\n\n    const toggleChatbot = () => {\n        setIsOpen(!isOpen);\n    };\n\n    const scrollToBottom = () => {\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    };\n\n    useEffect(() => {\n        scrollToBottom();\n    }, [messages]);\n\n    const handleSend = async () => {\n        if (input.trim() === '') return;\n\n        const userMessage = { type: 'user', text: input };\n        setMessages((prevMessages) => [...prevMessages, userMessage]);\n        setInput('');\n        setIsLoading(true);\n\n        // Capture the input message here, as `input` will be cleared before the async call\n        const currentInputMessage = input;\n\n        try {\n            // Prepare chat history for the backend\n            // Note: Your backend doesn't seem to use chatHistory for RAG context,\n            // but if it did, you'd send it like this.\n            const chatHistoryForLLM = messages.map(msg => ({\n                type: msg.type,\n                text: msg.text\n            }));\n\n            // --- CORRECTED AXIOS CALL ---\n            const response = await axios.post('/chat', {\n                // Axios automatically sets Content-Type: application/json\n                // and stringifies the data if it's an object.\n                message: currentInputMessage, // Pass the message directly as part of the data object\n                chatHistory: chatHistoryForLLM // If your backend expects chat history\n            });\n            // --- END CORRECTED AXIOS CALL ---\n\n            // Axios responses are already parsed into .data\n            const data = response.data; // Axios response object has a .data property\n\n            setMessages((prevMessages) => [...prevMessages, { type: 'bot', text: data.reply }]);\n        } catch (error) {\n            console.error('Error sending message:', error);\n            // More specific error message if backend returns one\n            const errorMessage = error.response && error.response.data && error.response.data.error\n                                 ? error.response.data.error\n                                 : 'Sorry, something went wrong. Please try again.';\n            setMessages((prevMessages) => [...prevMessages, { type: 'bot', text: errorMessage }]);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const handleKeyPress = (e) => {\n        if (e.key === 'Enter') {\n            handleSend();\n        }\n    };\n\n    return (\n        <div className=\"chatbot-container\">\n            <div className=\"chatbot-toggle-button\" onClick={toggleChatbot}>\n                <IoChatbubbleEllipsesSharp size={30} />\n            </div>\n\n            {isOpen && (\n                <div className=\"chatbot-window\">\n                    <div className=\"chatbot-header\">\n                        <h3>Virtual Assistant</h3>\n                        <button className=\"close-button\" onClick={toggleChatbot}>X</button>\n                    </div>\n                    <div className=\"chatbot-messages\">\n                        {messages.length === 0 && (\n                            <div className=\"welcome-message\">\n                                <p>Hi there! How can I help you today?</p>\n                            </div>\n                        )}\n                        {messages.map((msg, index) => (\n                            <div key={index} className={`message ${msg.type}`}>\n                                <p>{msg.text}</p>\n                            </div>\n                        ))}\n                        {isLoading && (\n                            <div className=\"message bot loading\">\n                                <p>...</p>\n                            </div>\n                        )}\n                        <div ref={messagesEndRef} />\n                    </div>\n                    <div className=\"chatbot-input-area\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Type your question...\"\n                            value={input}\n                            onChange={(e) => setInput(e.target.value)}\n                            onKeyPress={handleKeyPress}\n                            disabled={isLoading}\n                        />\n                        <button onClick={handleSend} disabled={isLoading}>\n                            <IoSend />\n                        </button>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default Chatbot;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}